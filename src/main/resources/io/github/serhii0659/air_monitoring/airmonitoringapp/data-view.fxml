<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import io.github.serhii0659.air_monitoring.airmonitoringapp.CustomTitleBar?>

<VBox xmlns:fx="http://javafx.com/fxml"
      fx:controller="io.github.serhii0659.air_monitoring.airmonitoringapp.DataViewController"
      style="-fx-background-color: linear-gradient(to bottom, #0a0e27, #1a1f3a); -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.8), 15, 0, 0, 5);">

    <!-- Custom Title Bar -->
    <CustomTitleBar fx:id="titleBar" />

    <!-- Main Content in StackPane -->
    <StackPane VBox.vgrow="ALWAYS">

        <!-- Main Content -->
        <BorderPane styleClass="border-pane">
            <top>
                <VBox spacing="12">
                    <padding>
                        <Insets top="15" right="15" bottom="15" left="15"/>
                    </padding>

                    <!-- Header -->
                    <HBox alignment="CENTER" spacing="10">
                        <Label text="âš¡" style="-fx-font-size: 28px; -fx-text-fill: #00d9ff;" />
                        <Label text="ÐŸÐ•Ð Ð•Ð“Ð›Ð¯Ð” Ð”ÐÐÐ˜Ð¥" styleClass="label-header" />
                        <Label text="âš¡" style="-fx-font-size: 28px; -fx-text-fill: #00d9ff;" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Label fx:id="usernameLabel" text="" styleClass="label-info"
                               style="-fx-text-fill: #00d9ff; -fx-font-size: 14px; -fx-font-weight: bold;" />
                    </HBox>

                    <!-- Controls -->
                    <HBox spacing="12" alignment="CENTER_LEFT">
                        <Label text="Ð¢Ð°Ð±Ð»Ð¸Ñ†Ñ:" styleClass="label-info" />
                        <ComboBox fx:id="tablesBox" prefWidth="280" />
                        <Button text="ðŸ”„ ÐžÐÐžÐ’Ð˜Ð¢Ð˜" onAction="#onRefresh" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Button text="â Ð’Ð†Ð”ÐšÐ›Ð®Ð§Ð˜Ð¢Ð˜Ð¡Ð¬" onAction="#onDisconnect" styleClass="button-danger" />
                    </HBox>

                    <!-- Info Label -->
                    <Label fx:id="infoLabel" styleClass="label-info" wrapText="true" />
                </VBox>
            </top>

            <center>
                <TableView fx:id="tableView" VBox.vgrow="ALWAYS" />
            </center>

            <bottom>
                <VBox spacing="8">
                    <!-- Pagination controls -->
                    <HBox fx:id="paginationBox" alignment="CENTER" spacing="15" visible="false" managed="false">
                        <padding>
                            <Insets top="8" right="15" bottom="5" left="15"/>
                        </padding>
                        <Button fx:id="prevPageBtn" text="â—€ ÐŸÐ¾Ð¿ÐµÑ€ÐµÐ´Ð½Ñ" onAction="#onPreviousPage" styleClass="button-secondary" />
                        <Label fx:id="pageLabel" text="Ð¡Ñ‚Ð¾Ñ€Ñ–Ð½ÐºÐ° 1 Ð· 1" styleClass="label-info" />
                        <Button fx:id="nextPageBtn" text="ÐÐ°ÑÑ‚ÑƒÐ¿Ð½Ð° â–¶" onAction="#onNextPage" styleClass="button-secondary" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Label fx:id="totalRecordsLabel" text="Ð’ÑÑŒÐ¾Ð³Ð¾: 0 Ð·Ð°Ð¿Ð¸ÑÑ–Ð²" styleClass="label-info" />
                    </HBox>

                    <!-- Settings row -->
                    <HBox alignment="CENTER_RIGHT" spacing="12">
                        <padding>
                            <Insets top="5" right="15" bottom="12" left="15"/>
                        </padding>
                        <Label text="Ð›Ñ–Ð¼Ñ–Ñ‚:" styleClass="label-info" />
                        <Spinner fx:id="limitSpinner" editable="true" prefWidth="120" />
                        <CheckBox fx:id="showAllCheckBox" text="ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚Ð¸ Ð²ÑÑ–" />
                    </HBox>
                </VBox>
            </bottom>
        </BorderPane>

        <!-- Loading Overlay (initially hidden) -->
        <VBox fx:id="loadingOverlay" alignment="CENTER" styleClass="loading-overlay"
              visible="false" managed="false">
            <VBox styleClass="loading-container" spacing="20" alignment="CENTER"
                  maxWidth="400" maxHeight="300">
                <Label text="âš¡ Ð—ÐÐ’ÐÐÐ¢ÐÐ–Ð•ÐÐÐ¯ Ð”ÐÐÐ˜Ð¥ âš¡" styleClass="label-title" />
                <ProgressBar fx:id="progressBar" prefWidth="350" prefHeight="20" />
                <Label fx:id="progressLabel" styleClass="label-info" wrapText="true"
                       alignment="CENTER" maxWidth="350" />
                <HBox spacing="15" alignment="CENTER">
                    <Label fx:id="progressPercent" text="0%" styleClass="label-title" />
                </HBox>
                <Button fx:id="cancelButton" text="âŒ Ð¡ÐšÐÐ¡Ð£Ð’ÐÐ¢Ð˜" onAction="#onCancelLoad"
                       styleClass="button-danger" prefWidth="150" />
            </VBox>
        </VBox>

    </StackPane>
</VBox>